<div class="dashboard-container">
  <h1>Tableau de Bord</h1>

  <div class="stats-grid">
    <div class="stat-card principal">
      <div class="icon revenue">ğŸ’°</div>
      <div class="stat-info">
        <span>Revenu Global</span>
        <h3>{{ totalRevenue() | number:'1.2-2' }} â‚¬</h3>
      </div>
    </div>

    <div class="stat-card">
      <div class="icon orders">ğŸ“œ</div>
      <div class="stat-info">
        <span>Commandes</span>
        <h3>{{ orderCount() }}</h3>
      </div>
    </div>

    <div class="stat-card">
      <div class="icon products">ğŸ“¦</div>
      <div class="stat-info">
        <span>Produits</span>
        <h3>{{ productCount() }}</h3>
      </div>
    </div>

    <div class="stat-card">
      <div class="icon categories">ğŸ“</div>
      <div class="stat-info">
        <span>CatÃ©gories</span>
        <h3>{{ categoryCount() }}</h3>
      </div>
    </div>
  </div>

  <div class="stats-grid temporal">
    <div class="stat-card today">
      <div class="stat-info">
        <span>Ventes (Aujourd'hui)</span>
        <h3 class="text-success">{{ revenueToday() | number:'1.2-2' }} â‚¬</h3>
      </div>
    </div>

    <div class="stat-card month">
      <div class="stat-info">
        <span>Ventes (Ce mois)</span>
        <h3 class="text-primary">{{ revenueMonth() | number:'1.2-2' }} â‚¬</h3>
      </div>
    </div>

    <div class="stat-card year">
      <div class="stat-info">
        <span>Ventes (Cette annÃ©e)</span>
        <h3 class="text-info">{{ revenueYear() | number:'1.2-2' }} â‚¬</h3>
      </div>
    </div>
  </div>

  <div class="charts-grid">
    <div class="chart-container">
      <h3>Ã‰volution des Ventes</h3>
      <canvas #salesChart></canvas>
    </div>

    <div class="chart-container">
      <h3>Top Produits (Ventes)</h3>
      <canvas #topProductsChart></canvas>
    </div>

    <div class="chart-card">
      <h3>RÃ©partition des Paiements</h3>
      <canvas #paymentMethodsChart></canvas>
    </div>
  </div>
</div>

<hr class="separator">

<div class="search-section">
  <div class="search-header">
    <h2>ğŸ” Recherche dÃ©taillÃ©e par jour</h2>
    <div class="search-controls">
      <label>Choisir une date : </label>
      <input type="date" [ngModel]="searchDate()" (ngModelChange)="onSearchDateChange($event)" class="date-input">
    </div>
  </div>

  <div class="results-table-container">
    <table class="results-table">
      <thead>
        <tr>
          <th>Heure</th>
          <th>Produits sortis</th>
          <th>MÃ©thode</th>
          <th class="text-right">Total</th>
        </tr>
      </thead>
      <tbody>
        @for (order of filteredOrders(); track order.id) {
        <tr>
          <td>{{ order.orderDate | date:'HH:mm' }}</td>
          <td>
            <div class="product-list">
              @for (item of order.items; track $index) {
              <span class="product-badge">
                {{ item.quantity }}x {{ item.productName }}
              </span>
              }
            </div>
          </td>
          <td><span class="payment-method">{{ order.paymentMethod }}</span></td>
          <td class="amount-cell text-right">{{ order.totalAmount | number:'1.2-2' }} â‚¬</td>
        </tr>
        } @empty {
        <tr>
          <td colspan="4" class="empty-msg">
            Aucune vente enregistrÃ©e pour le {{ searchDate() | date:'dd/MM/yyyy' }}
          </td>
        </tr>
        }
      </tbody>
      @if (filteredOrders().length > 0) {
      <tfoot>
        <tr>
          <td colspan="3"><strong>Total de la journÃ©e sÃ©lectionnÃ©e</strong></td>
          <td class="total-day text-right">{{ totalFilteredRevenue() | number:'1.2-2' }} â‚¬</td>
        </tr>
      </tfoot>
      }
    </table>
  </div>
</div>
